<!--
  copyright (c) 2009 Google inc.

  You are free to copy and use this sample.
  License can be found here: http://code.google.com/apis/ajaxsearch/faq/#license
-->

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
    <title>
      Google Visualization API Sample
    </title>
    <script type="text/javascript" src="http://www.google.com/jsapi"></script>
    <script type="text/javascript">
      google.load('visualization', '1', {packages: ["piechart"]});
    </script>
    <script type="text/javascript">
    var visualization;

    function drawVisualization() {
      // To see the data that this visualization uses, browse to
      // http://spreadsheets.google.com/ccc?key=pCQbetd-CptGXxxQIG7VFIQ  
      var query = new google.visualization.Query(
          'http://spreadsheets.google.com/pub?key=tX8ldRZ61vk_DCAf7IZnLBg&output=html');
			
			// Optional request to return only column C and the sum of column B, grouped by C members.
			query.setQuery('select A,B');

  
      // Send the query with a callback function.
      query.send(handleQueryResponse);
    }
    
    function handleQueryResponse(response) {
      if (response.isError()) {
        alert('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
        return;
      }
    
      var data = response.getDataTable();
      var pChart = new google.visualization.PieChart(document.getElementById('visualization'));
      pChart.draw(data, {is3D: true});
    }

    google.setOnLoadCallback(drawVisualization);
    </script>
  </head>
  <body style="font-family: Arial;border: 0 none;">
    <div id="container" style="height:600;width:550px;border:1px solid black">
      <div style="color:#0000FF;font-size:25px;text-align:center;"><b>Negawatts* Generated by HEEP Rebates - 2009</b></div>
      <div id="visualization" style="height:300px; width:400px;"></div>
      <div style="float:right; margin-right:50px;"><IMG SRC="tooltip_40.jpg" ALT="Tooltip"></div>
      <div style="color:red; width:50%;margin:auto;" align="center">Total:<br />10700 kilo-negawatts</div>
      <div style="color:blue; font-size:12px; margin-top:8px; margin-bottom:5px;text-align:center;" align="center">10.6 kilo-negawatts were generated per rebate dollar spent</div>
    </div>
  </body>
</html>
